import{g as e,d as a,v as l,e as s,G as o,n as t,u as i,c as n,q as u,p as c,H as r,a as v,w as d,P as p,Q as m,U as f,F as h,J as y,M as g,N as _,o as w,V as k,t as b,x as S,B as x,E as C,C as z,A as M,W as T,X as j,Y as R}from"./vue-vendor-ea954c2b.js";import{e as H,_ as O,p as I,q as P}from"./common-01692133.js";import{I as K,b as q,a as D}from"./image-modules-fe18f5da.js";import{j as L,h as A,i as B,D as J,q as N,E as U,p as $,v as E,x as F,s as V}from"./naive-ui-39fa6320.js";const W=e("movie",{state:()=>({searchKeyword:"",searchResults:[]}),actions:{setSearchResults(e){this.searchResults=e},setSearchKeyword(e){this.searchKeyword=e}}}),G=e=>(g("data-v-1ff90a0e"),e=e(),_(),e),Q={class:"flex flex-col w-full h-full"},X={class:"flex-1 overflow-hidden"},Y={id:"scrollRef",class:"h-full overflow-hidden overflow-y-auto"},Z={class:"movie-search-container"},ee={class:"search-container"},ae={class:"search-wrapper"},le={class:"search-input-wrapper"},se={key:0,class:"suggestion-section"},oe={class:"section-header"},te=G((()=>c("span",null,"搜索历史",-1))),ie=["onClick"],ne={class:"history-list"},ue={class:"history-grid"},ce=["onClick"],re={class:"history-text"},ve={class:"source-tag"},de=["onClick"],pe={class:"suggestion-section"},me=G((()=>c("div",{class:"section-header"},[c("span",null,"热搜榜")],-1))),fe={class:"hot-search-list"},he=["onClick"],ye={class:"hot-text"},ge={class:"results-container"},_e=["onClick"],we={class:"movie-image"},ke={class:"movie-info"},be={class:"type-tag"},Se=D(a({__name:"MovieSearch",setup(e){const{isMobile:a}=H(),g=x(),_=W(),C=l(_.searchKeyword),z=s((()=>_.searchResults)),M=l(!1),T=l([{label:"来源一",value:"1"},{label:"来源二",value:"2"},{label:"来源三",value:"3"},{label:"来源四",value:"4"},{label:"来源五",value:"5"}]),j=l("1"),R=l([]),P=l(!1),D=l([{text:"娼年",tag:"热"},{text:"回复术士的重来人生",tag:"R18"},{text:"无良公会",tag:"新"}]),U=l(!1);let $=null;const E=l(!1);function F(){$&&(clearTimeout($),$=null),U.value=!0}function V(){$=setTimeout((()=>{E.value||(U.value=!1)}),200)}function G(){$&&(clearTimeout($),$=null)}function Se(){V()}o((()=>{$&&(clearTimeout($),$=null)}));try{const e=localStorage.getItem("movieSearchHistory");e&&(R.value=JSON.parse(e))}catch(Me){R.value=[]}async function xe(e){e&&(C.value=e),U.value=!1;const a=e||C.value;if(a.trim()){P.value=!1,M.value=!0;try{const e=await I(a,j.value);0===e.code&&(_.setSearchResults(e.data),_.setSearchKeyword(a),function(e){if(!e.trim())return;const a={keyword:e.trim(),source:j.value,timestamp:Date.now()};R.value=R.value.filter((e=>!(e.keyword===a.keyword&&e.source===a.source))),R.value.unshift(a),R.value.length>10&&R.value.pop(),localStorage.setItem("movieSearchHistory",JSON.stringify(R.value))}(a))}catch(l){}finally{M.value=!1}}}function Ce(){R.value=[],localStorage.removeItem("movieSearchHistory")}function ze(e){switch(e){case"热":case"R18":return"hot";case"新":return"new";case"直播中":return"live";default:return""}}return o((()=>{_.setSearchKeyword(C.value)})),(e,l)=>(w(),t("div",Q,[i(a)?(w(),n(q,{key:0})):u("",!0),c("main",X,[c("div",Y,[c("div",{id:"movie-wrapper",class:r(["w-full max-w-screen-xl m-auto",[i(a)?"p-2":"p-4"]])},[c("div",Z,[c("div",ee,[c("div",ae,[c("div",le,[v(i(J),null,{default:d((()=>[v(i(L),{value:j.value,"onUpdate:value":l[0]||(l[0]=e=>j.value=e),style:{width:"25%"},"default-value":j.value,options:T.value,size:"large",placeholder:"数据源","show-checkmark":!1},null,8,["value","default-value","options"]),v(i(A),{value:C.value,"onUpdate:value":l[2]||(l[2]=e=>C.value=e),style:{width:"75%"},size:"large",type:"text",placeholder:"影视名称关键字",clearable:"",loading:M.value,onKeyup:l[3]||(l[3]=k((e=>xe()),["enter"])),onFocus:F,onBlur:V},{suffix:d((()=>[v(i(B),{disabled:M.value,secondary:"",onClick:l[1]||(l[1]=e=>xe())},{icon:d((()=>[v(i(O),{icon:i(K).nav.search,class:"search-icon"},null,8,["icon"])])),_:1},8,["disabled"])])),_:1},8,["value","loading"])])),_:1})]),p(c("div",{class:"search-suggestions",onMouseenter:G,onMouseleave:Se},[R.value.length>0?(w(),t("div",se,[c("div",oe,[te,c("span",{class:"clear-history",onClick:f(Ce,["stop"])},"清空",8,ie)]),c("div",ne,[c("div",ue,[(w(!0),t(h,null,y(R.value,((e,a)=>{var l;return w(),t("div",{key:`history-${a}`,class:"history-item",onClick:a=>async function(e){j.value=e.source,await xe(e.keyword)}(e)},[c("span",re,[c("span",ve,"["+b(null==(l=T.value.find((a=>a.value===e.source)))?void 0:l.label)+"]",1),S(" "+b(e.keyword),1)]),c("span",{class:"delete-icon",onClick:f((e=>function(e){E.value=!0,R.value.splice(e,1),localStorage.setItem("movieSearchHistory",JSON.stringify(R.value)),setTimeout((()=>{E.value=!1}),300)}(a)),["stop","prevent"])},"×",8,de)],8,ce)})),128))])])])):u("",!0),c("div",pe,[me,c("div",fe,[(w(!0),t(h,null,y(D.value,((e,a)=>(w(),t("div",{key:`hot-${a}`,class:"suggestion-item",onClick:a=>xe(e.text)},[c("span",{class:r(["hot-rank",{"top-3":a<3}])},b(a+1),3),c("span",ye,b(e.text),1),e.tag?(w(),t("span",{key:0,class:r(["hot-tag",ze(e.tag)])},b(e.tag),3)):u("",!0)],8,he)))),128))])])],544),[[m,U.value]])])]),c("div",ge,[(w(!0),t(h,null,y(i(z),(e=>(w(),t("div",{key:e.vod_id,class:"movie-card",onClick:a=>i(g).push(`/movie/movie-detail/${j.value}/${e.vod_id}`)},[c("div",we,[v(i(N),{lazy:"",src:e.vod_pic,alt:e.vod_name,"preview-disabled":"","object-fit":"cover","intersection-observer-options":{root:"#scrollRef",rootMargin:"200px 0px",threshold:.1}},null,8,["src","alt","intersection-observer-options"])]),c("div",ke,[c("h3",null,b(e.vod_name),1),c("span",be,b(e.type_name),1)])],8,_e)))),128))])])],2)])])]))}}),[["__scopeId","data-v-1ff90a0e"]]),xe=Object.freeze(Object.defineProperty({__proto__:null,default:Se},Symbol.toStringTag,{value:"Module"})),Ce=e=>(g("data-v-54c216da"),e=e(),_(),e),ze={class:"flex flex-col w-full h-full"},Me={class:"flex-1 overflow-hidden"},Te={id:"scrollRef",class:"h-full overflow-hidden overflow-y-auto"},je={class:"movie-detail-container"},Re={key:0,class:"player-wrapper"},He={key:1,class:"info-section"},Oe={class:"movie-header"},Ie={class:"movie-cover-wrapper"},Pe={class:"movie-info"},Ke={class:"info-item"},qe=Ce((()=>c("span",{class:"label"},"类型：",-1))),De={class:"info-item"},Le=Ce((()=>c("span",{class:"label"},"导演：",-1))),Ae={class:"info-item"},Be=Ce((()=>c("span",{class:"label"},"主演：",-1))),Je={class:"info-items"},Ne={class:"info-item"},Ue=Ce((()=>c("span",{class:"label"},"地区：",-1))),$e={class:"info-item"},Ee=Ce((()=>c("span",{class:"label"},"语言：",-1))),Fe={class:"info-item"},Ve=Ce((()=>c("span",{class:"label"},"状态：",-1))),We={class:"info-item"},Ge=Ce((()=>c("span",{class:"label"},"简介：",-1))),Qe=["innerHTML"],Xe={class:"info-item"},Ye=Ce((()=>c("span",{class:"label"},"地区：",-1))),Ze={class:"info-item"},ea=Ce((()=>c("span",{class:"label"},"语言：",-1))),aa={class:"info-item"},la=Ce((()=>c("span",{class:"label"},"状态：",-1))),sa={class:"info-item"},oa=Ce((()=>c("span",{class:"label"},"简介：",-1))),ta=["innerHTML"],ia={key:2,class:"expand-more"},na={key:2,class:"episodes-section"},ua={class:"pagination-wrapper"},ca=D(a({__name:"MovieDetail",setup(e){const{isMobile:a}=H(),p=M(),m=l(!0),f=l(null),g=l(""),_=l(0),k=l(!1),x=l({page:1,pageSize:20,itemCount:0}),O=s((()=>{var e;if(!(null==(e=f.value)?void 0:e.vod_play_urls))return[];const a=(x.value.page-1)*x.value.pageSize,l=a+x.value.pageSize;return f.value.vod_play_urls.slice(a,l)}));function I(e){x.value.page=e,window.scrollTo({top:0,behavior:"smooth"})}const K=l(null);function D(e,a,l){if(R.isSupported()){l.hls&&l.hls.destroy();const s=new R;s.loadSource(a),s.attachMedia(e),l.hls=s,l.on("destroy",(()=>s.destroy()))}else e.canPlayType("application/vnd.apple.mpegurl")?e.src=a:l.notice.show="不支持的播放格式：m3u8"}function L(e){K.value&&(K.value.destroy(),K.value=null),z((()=>{const a=document.querySelector(".player-wrapper");a&&(K.value=new T({container:a,url:e,type:"m3u8",customType:{m3u8:D},volume:.5,isLive:!1,muted:!1,autoplay:!0,hotkey:!0,pip:!0,autoSize:!0,autoMini:!0,setting:!0,loop:!1,flip:!0,playbackRate:!0,aspectRatio:!0,fullscreen:!0,fullscreenWeb:!0,subtitleOffset:!0,miniProgressBar:!0,mutex:!0,backdrop:!0,playsInline:!0,autoPlayback:!0,theme:"#23ade5",lang:"zh-cn",moreVideoAttr:{crossOrigin:"anonymous",preload:"auto"},settings:[{width:200,html:"字幕",tooltip:"双语",selector:[{html:"显示",tooltip:"显示",switch:!0,onSwitch:e=>(e.tooltip=e.switch?"隐藏":"显示",K.value&&(K.value.subtitle.show=!e.switch),!e.switch)}]}],contextmenu:[{html:"播放器信息",click(e){e.show=!1}}],icons:{loading:"加载中，知道你很急，但是你先别急..."},plugins:[j({html:'<img src="https://cdn.lookimage.live/assets/img/video_ads-989f688b.png" style="max-width: 55%; height: auto;">',url:"https://www.profitablecpmrate.com/esayrydd5?key=76d97011d161ef42efe0d75ec211c794",playDuration:5,totalDuration:10,i18n:{close:"关闭广告",countdown:"%s秒",detail:"查看详情",canBeClosed:"%s秒后可关闭广告"}})]}),K.value&&(K.value.on("error",(()=>{})),K.value.on("ready",(()=>{})),K.value.on("artplayerPluginAds:click",(e=>{})),K.value.on("artplayerPluginAds:skip",(e=>{}))))}))}return C((()=>{!async function(){try{const e=await P(p.params.source,p.params.id);0===e.code&&e.data.length>0&&(f.value=e.data[0],x.value.itemCount=f.value.vod_play_urls.length,f.value.vod_play_urls.length>0&&(g.value=f.value.vod_play_urls[0].play_url,_.value=0,z((()=>{L(g.value)}))))}catch(e){}finally{m.value=!1}}()})),o((()=>{K.value&&(K.value.destroy(),K.value=null)})),(e,l)=>{var s;return w(),t("div",ze,[i(a)?(w(),n(q,{key:0})):u("",!0),c("main",Me,[c("div",Te,[c("div",je,[g.value?(w(),t("div",Re)):u("",!0),f.value?(w(),t("div",He,[v(i($),null,{default:d((()=>[c("div",Oe,[c("div",Ie,[v(i(N),{src:f.value.vod_pic,alt:f.value.vod_name,class:"movie-cover","preview-disabled":"","object-fit":"cover"},null,8,["src","alt"])]),c("div",Pe,[c("h1",null,b(f.value.vod_name),1),v(i(U),{vertical:"",size:"small"},{default:d((()=>[c("div",Ke,[qe,c("span",null,b(f.value.type_name),1)]),c("div",De,[Le,c("span",null,b(f.value.vod_director),1)]),c("div",Ae,[Be,c("span",null,b(f.value.vod_actor),1)]),i(a)?(w(),t("div",{key:0,class:r(["expandable-content",{collapsed:!k.value}])},[c("div",Je,[c("div",Ne,[Ue,c("span",null,b(f.value.vod_area),1)]),c("div",$e,[Ee,c("span",null,b(f.value.vod_lang),1)]),c("div",Fe,[Ve,c("span",null,b(f.value.vod_remarks),1)]),c("div",We,[Ge,c("div",{class:"movie-desc",innerHTML:f.value.vod_content},null,8,Qe)])])],2)):(w(),t(h,{key:1},[c("div",Xe,[Ye,c("span",null,b(f.value.vod_area),1)]),c("div",Ze,[ea,c("span",null,b(f.value.vod_lang),1)]),c("div",aa,[la,c("span",null,b(f.value.vod_remarks),1)]),c("div",sa,[oa,c("div",{class:"movie-desc",innerHTML:f.value.vod_content},null,8,ta)])],64)),i(a)?(w(),t("div",ia,[v(i(B),{text:"",onClick:l[0]||(l[0]=e=>k.value=!k.value)},{default:d((()=>[S(b(k.value?"收起":"展开更多"),1)])),_:1})])):u("",!0)])),_:1})])])])),_:1})])):u("",!0),(null==(s=f.value)?void 0:s.vod_play_urls.length)?(w(),t("div",na,[v(i($),{title:"剧集列表"},{default:d((()=>[v(i(E),{cols:i(a)?4:8,"x-gap":8,"y-gap":8},{default:d((()=>[(w(!0),t(h,null,y(i(O),((e,a)=>(w(),n(i(F),{key:e.play_id},{default:d((()=>[v(i(B),{block:"",type:_.value===(x.value.page-1)*x.value.pageSize+a?"primary":"default",onClick:l=>function(e,a){g.value=e,_.value=a,L(e)}(e.play_url,(x.value.page-1)*x.value.pageSize+a)},{default:d((()=>[S(b(e.play_num),1)])),_:2},1032,["type","onClick"])])),_:2},1024)))),128))])),_:1},8,["cols"]),c("div",ua,[v(i(V),{page:x.value.page,"onUpdate:page":[l[1]||(l[1]=e=>x.value.page=e),I],size:i(a)?"small":"medium","item-count":x.value.itemCount,"page-size":x.value.pageSize,"show-quick-jumper":""},null,8,["page","size","item-count","page-size"])])])),_:1})])):u("",!0)])])])])}}}),[["__scopeId","data-v-54c216da"]]),ra=Object.freeze(Object.defineProperty({__proto__:null,default:ca},Symbol.toStringTag,{value:"Module"}));export{xe as M,ra as a};
