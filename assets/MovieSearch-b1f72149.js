import{d as R,u as V,l as c,v as E,c as l,a as r,b as U,e as y,f as e,n as S,h as g,w as N,ai as z,a0 as Y,aj as q,ak as $,F as x,r as w,p as A,g as G,o as i,B as P,_ as Q,I as W,Y as X,t as d,i as Z,al as ee,j as se}from"./index-a53ea9c5.js";import{_ as te}from"./index.vue_vue_type_script_setup_true_lang-482da42f.js";import{N as oe}from"./Image-05b5ce37.js";const b=v=>(A("data-v-8c09a0ef"),v=v(),G(),v),ae={class:"flex flex-col w-full h-full"},ne={class:"flex-1 overflow-hidden"},ie={id:"scrollRef",class:"h-full overflow-hidden overflow-y-auto"},le={class:"movie-search-container"},ce={class:"search-container"},re={class:"search-wrapper"},ue={class:"search-input-wrapper"},de={key:0,class:"suggestion-section"},ve={class:"section-header"},he=b(()=>e("span",null,"搜索历史",-1)),_e=["onClick"],fe={class:"history-list"},pe={class:"history-grid"},ge=["onClick"],me={class:"history-text"},ye=["onClick"],Se={class:"suggestion-section"},xe=b(()=>e("div",{class:"section-header"},[e("span",null,"热搜榜")],-1)),we={class:"hot-search-list"},ke=["onClick"],Ce={class:"hot-text"},Ie={class:"results-container"},Me=["onClick"],Ne={class:"movie-image"},$e={class:"movie-info"},be={class:"type-tag"},Be=R({__name:"MovieSearch",setup(v){const{isMobile:k}=V(),B=Z(),h=c(""),C=c([]),_=c(!1),o=c([]),H=c(!1),T=c([{text:"娼年",tag:"热"},{text:"明天，我会成为谁的女友",tag:"热"}]),f=c(!1);let n=null;const m=c(!1);function F(){n&&(clearTimeout(n),n=null),f.value=!0}function I(){n=setTimeout(()=>{m.value||(f.value=!1)},200)}function O(){n&&(clearTimeout(n),n=null)}function j(){I()}E(()=>{n&&(clearTimeout(n),n=null)});function D(a){if(!a.trim())return;const t=o.value.indexOf(a);t>-1&&o.value.splice(t,1),o.value.unshift(a),o.value.length>10&&o.value.pop(),localStorage.setItem("movieSearchHistory",JSON.stringify(o.value))}o.value=JSON.parse(localStorage.getItem("movieSearchHistory")||"[]");async function p(a){a&&(h.value=a),f.value=!1;const t=a||h.value;if(t.trim()){H.value=!1,_.value=!0;try{const s=await ee(t);s.code===0&&(C.value=s.data,D(t))}catch(s){console.error("Search failed:",s)}finally{_.value=!1}}}function J(){o.value=[],localStorage.removeItem("movieSearchHistory")}function K(a){switch(a){case"热":return"hot";case"新":return"new";case"直播中":return"live";default:return""}}function L(a){m.value=!0,o.value.splice(a,1),localStorage.setItem("movieSearchHistory",JSON.stringify(o.value)),setTimeout(()=>{m.value=!1},300)}return(a,t)=>(i(),l("div",ae,[r(k)?(i(),U(te,{key:0})):y("",!0),e("main",ne,[e("div",ie,[e("div",{id:"movie-wrapper",class:S(["w-full max-w-screen-xl m-auto",[r(k)?"p-2":"p-4"]])},[e("div",le,[e("div",ce,[e("div",re,[e("div",ue,[g(r(X),{value:h.value,"onUpdate:value":t[1]||(t[1]=s=>h.value=s),type:"text",placeholder:"请输入影视名称关键字",clearable:"",loading:_.value,onKeyup:t[2]||(t[2]=z(s=>p(),["enter"])),onFocus:F,onBlur:I},{suffix:N(()=>[g(r(P),{disabled:_.value,secondary:"",onClick:t[0]||(t[0]=s=>p())},{icon:N(()=>[g(r(Q),{icon:r(W).nav.search,class:"search-icon"},null,8,["icon"])]),_:1},8,["disabled"])]),_:1},8,["value","loading"])]),Y(e("div",{class:"search-suggestions",onMouseenter:O,onMouseleave:j},[o.value.length>0?(i(),l("div",de,[e("div",ve,[he,e("span",{class:"clear-history",onClick:$(J,["stop"])},"清空",8,_e)]),e("div",fe,[e("div",pe,[(i(!0),l(x,null,w(o.value,(s,u)=>(i(),l("div",{key:`history-${u}`,class:"history-item",onClick:M=>p(s)},[e("span",me,d(s),1),e("span",{class:"delete-icon",onClick:$(M=>L(u),["stop","prevent"])},"×",8,ye)],8,ge))),128))])])])):y("",!0),e("div",Se,[xe,e("div",we,[(i(!0),l(x,null,w(T.value,(s,u)=>(i(),l("div",{key:`hot-${u}`,class:"suggestion-item",onClick:M=>p(s.text)},[e("span",{class:S(["hot-rank",{"top-3":u<3}])},d(u+1),3),e("span",Ce,d(s.text),1),s.tag?(i(),l("span",{key:0,class:S(["hot-tag",K(s.tag)])},d(s.tag),3)):y("",!0)],8,ke))),128))])])],544),[[q,f.value]])])]),e("div",Ie,[(i(!0),l(x,null,w(C.value,s=>(i(),l("div",{key:s.vod_id,class:"movie-card",onClick:u=>r(B).push(`/movie/movie-detail/${s.vod_id}`)},[e("div",Ne,[g(r(oe),{src:s.vod_pic,alt:s.vod_name,"preview-disabled":"","object-fit":"cover","intersection-observer-options":{root:null,rootMargin:"100px 0px",threshold:.1}},null,8,["src","alt","intersection-observer-options"])]),e("div",$e,[e("h3",null,d(s.vod_name),1),e("span",be,d(s.type_name),1)])],8,Me))),128))])])],2)])])]))}});const Oe=se(Be,[["__scopeId","data-v-8c09a0ef"]]);export{Oe as default};
